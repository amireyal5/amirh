{{ define "main" }}
<main class="main single" role="main"> <!-- Changed class from homepage to single for clarity -->
    <article class="post">
        <!-- REMOVED: The old header structure. The main site header is now handled globally by baseof.html. -->
        <!-- <header class="post__header">
            <h1 class="post__title">{{ .Title }}</h1>
            {{- with .Params.lead }}
            <p class="post__lead">{{ . }}</p>
            {{- end }}
            {{ with partial "post_meta.html" . -}}
            <div class="post__meta meta">{{ . }}</div>
            {{- end }}
        </header> -->

        {{ partial "post_thumbnail.html" (dict "class" "post" "page" .) }}
        {{- partial "post_toc.html" . -}}

        <div class="content post__content clearfix">
            <!-- CRITICAL FIX: Re-added post title and meta here, so they appear within the main content area -->
            <h1 class="post__title">{{ .Title }}</h1>
            {{- with .Params.lead }}
            <p class="post__lead">{{ . }}</p>
            {{- end }}
            {{ with partial "post_meta.html" . -}}
            <div class="post__meta meta">{{ . }}</div>
            {{- end }}
            
            {{ .Content }}
        </div>
        
        {{- if .Params.tags }}
        <footer class="post__footer">
            {{ partial "post_tags.html" . }}
        </footer>
        {{- end }}
    </article>
</main>

{{ partial "pager.html" . }}
{{ partial "comments.html" . }}
{{ end }}
